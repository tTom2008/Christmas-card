<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry Christmas Greeting</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: #060606;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
            color: white;
            font-family: 'Segoe UI', sans-serif;
        }

#glass-card {
    position: relative;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 25px;
    padding: 20px; /* Gi·∫£m padding */
    width: 90%;
    max-width: 500px;
    max-height: 90vh; /* Kh√¥ng bao gi·ªù v∆∞·ª£t qu√° chi·ªÅu cao m√†n h√¨nh */
    overflow-y: auto; /* Hi·ªán thanh cu·ªôn n·∫øu n·ªôi dung qu√° d√†i */
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.greeting-text {
    font-size: clamp(1.2rem, 5vw, 2rem); /* Font ch·ªØ th√¥ng minh */
    line-height: 1.4;
}

        input {
            width: 80%; padding: 12px; margin: 20px 0;
            border-radius: 10px; border: 1px solid #FFD700;
            background: rgba(255,255,255,0.1); color: white;
            text-align: center; font-size: 1.1rem; outline: none;
        }
        button {
            padding: 12px 30px; border-radius: 25px; border: none;
            background: linear-gradient(45deg, #FFD700, #B8860B);
            color: black; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        button:hover { transform: scale(1.05); box-shadow: 0 0 15px #FFD700; }

        .greeting-text {
            font-family: 'Dancing Script', 'Segoe UI', cursive;
            font-size: clamp(1.4rem, 4vw, 2.1rem);
            background: linear-gradient(135deg, #FFD700 0%, #FFF8DC 50%, #FFD700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            line-height: 1.6;
        }

        .sub-text {
            margin-top: 20px;
            font-size: 0.8rem;
            color: #666;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .snow-dot {
            position: absolute; background: white; border-radius: 50%; opacity: 0.5;
            pointer-events: none; animation: fall linear infinite;
        }
        @keyframes fall {
            to { transform: translateY(100vh); }
        }

        .typed-cursor {
            color: #FFD700;
        }
    </style>
</head>
<body>
<audio id="bgMusic" autoplay loop>
¬† ¬† <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
¬† ¬† // ƒê·∫£m b·∫£o nh·∫°c ph√°t ngay khi trang v·ª´a load xong
¬† ¬† window.addEventListener('load', function() {
¬† ¬† ¬† ¬† const music = document.getElementById('bgMusic');
¬† ¬† ¬† ¬† const playPromise = music.play();

¬† ¬† ¬† ¬† if (playPromise !== undefined) {
¬† ¬† ¬† ¬† ¬† ¬† playPromise.then(_ => {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† console.log("Nh·∫°c ƒë√£ t·ª± ƒë·ªông ph√°t ·ªü trang B!");
¬† ¬† ¬† ¬† ¬† ¬† }).catch(error => {
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† // Tr∆∞·ªùng h·ª£p tr√¨nh duy·ªát v·∫´n ch·∫∑n (hi·∫øm khi x·∫£y ra sau khi ƒë√£ click ·ªü trang A)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† console.log("C·∫ßn click ƒë·ªÉ ph√°t nh·∫°c");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† // T·ª± ƒë·ªông ph√°t l·∫°i khi ng∆∞·ªùi d√πng ch·∫°m v√†o m√†n h√¨nh trang B
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.body.addEventListener('click', () => music.play(), { once: true });
¬† ¬† ¬† ¬† ¬† ¬† });
¬† ¬† ¬† ¬† }
¬† ¬† });
</script>

    <div id="glass-card">
        <div id="input-area">
            <h2 style="color: #FFD700; font-family: 'Dancing Script'; font-size: 2.5rem;">Gi√°ng Sinh cu·ªëi c·∫•p, <br> B·∫°n t√™n l√† g√¨?</h2>
            <input type="text" id="nameInput" placeholder="Nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç v√† t√™n..." autocomplete="off">
            <br>
            <button onclick="startMagic()">Xem ƒëi·ªÅu b·∫•t ng·ªù</button>
        </div>

        <div id="display-area" style="display: none;">
            <div class="greeting-text" id="typed"></div>
            <div class="sub-text">A miracle is about to unfold...</div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
    <script>
        // H√†m x√≥a d·∫•u c·ª±c m·∫°nh (Unicode Normalization)
        function getCleanText(str) {
            if (!str) return "";
            return str.toLowerCase()
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "")
                .replace(/ƒë/g, "d")
                .replace(/\s+/g, " ")
                .trim();
        }

        function startMagic() {
            const fullNameInput = document.getElementById('nameInput').value.trim();
            if (!fullNameInput) {
                alert("H√£y nh·∫≠p t√™n nh√©!");
                return;
            }

            // Ph√°t nh·∫°c
            const music = document.getElementById('bgMusic');
            music.play().catch(e => console.log("Music play blocked"));

            // CHU·∫®N H√ìA D·ªÆ LI·ªÜU NH·∫¨P
            const cleanFull = getCleanText(fullNameInput); // V√≠ d·ª•: "nguyen ngoc han"
            const nameParts = cleanFull.split(" ");
            const firstNameOnly = nameParts[nameParts.length - 1]; // V√≠ d·ª•: "han"

            let selectedWish = "";
            let userType = "nam"; // M·∫∑c ƒë·ªãnh l√† nam

            // DANH S√ÅCH N·ªÆ G·ªêC (B·∫Øt bu·ªôc vi·∫øt kh√¥ng d·∫•u, ch·ªØ th∆∞·ªùng)
            const listNuGoc = ["ngoc han", "my han", "thu huong", "bao ngoc", "nhu ngoc", "tieu phung", "minh thu", "thu trang", "ngoc tram", "cam tu", "thanh phuong"];

            // --- LOGIC L·ªåC T√äN TH√îNG MINH ---
            
            // 1. Ki·ªÉm tra Th·∫ßy tr∆∞·ªõc
            if (cleanFull.includes("tuan anh")) {
                userType = "thay";
                selectedWish = `G·ª≠i Th·∫ßy Tu·∫•n Anh! ‚ùÑÔ∏è <br> C·∫£m ∆°n Th·∫ßy ƒë√£ ƒë·ªìng h√†nh c√πng ch√∫ng em trong nƒÉm cu·ªëi. ^500 <br> Ch√∫c Th·∫ßy Gi√°ng Sinh an l√†nh v√† r·ª±c r·ª°! üéÅ`;
            } 
            else {
                // 2. Ki·ªÉm tra N·ªØ theo 2 b∆∞·ªõc:
                // B∆∞·ªõc A: Kh·ªõp c·∫£ h·ªç t√™n ƒë·ªám (N·∫øu h·ªç nh·∫≠p: "Nguy·ªÖn Ng·ªçc H√¢n")
                let checkNu = listNuGoc.some(tenNu => cleanFull.includes(tenNu));

                // B∆∞·ªõc B: N·∫øu B∆∞·ªõc A kh√¥ng kh·ªõp, ki·ªÉm tra c√°i T√™n cu·ªëi c√πng (N·∫øu h·ªç ch·ªâ nh·∫≠p: "H√¢n")
                if (!checkNu) {
                    checkNu = listNuGoc.some(tenNu => {
                        const parts = tenNu.split(" ");
                        return parts[parts.length - 1] === firstNameOnly;
                    });
                }

                if (checkNu) {
                    userType = "nu";
                    const wishesNu = [
                        `Ch√†o ${fullNameInput}! ‚ùÑÔ∏è <br> Ch√∫c b·∫°n √¥n thi hi·ªáu qu·∫£, ƒë·ªó ƒë√∫ng nguy·ªán v·ªçng 1 nh√©! ‚ú®`,
                        `${fullNameInput} ∆°i! üéÑ <br> Gi√°ng Sinh vui v·∫ª! Lu√¥n gi·ªØ v·ªØng phong ƒë·ªô h·ªçc t·∫≠p! ‚ù§Ô∏è`,
                        `Merry Xmas, ${fullNameInput}! üß∏ <br> Ch√∫c b·∫°n s·ªõm nh·∫≠n tin vui ƒë·ªó ƒê·∫°i h·ªçc! ‚ú®`,
                        `Ch√†o ${fullNameInput}! üåü <br> Ch√∫c b·∫°n lu√¥n r·∫°ng r·ª° v√† c·∫ßm ch·∫Øc t·∫•m v√© tr∆∞·ªùng Top!`
                    ];
                    selectedWish = wishesNu[Math.floor(Math.random() * wishesNu.length)];
                } else {
                    userType = "nam";
                    const wishesNam = [
                        `Ch√†o ${fullNameInput}! ‚ùÑÔ∏è <br> Noel ch√°y nh√©! Ch√∫c √¥ng thi ƒë√¢u ƒë·ªó ƒë√≥! ‚ú®`,
                        `${fullNameInput} ∆°i! üéÑ <br> Gi√°ng Sinh an l√†nh! S·ªõm ƒë·ªó nguy·ªán v·ªçng 1 nh√©! ‚ù§Ô∏è`,
                        `Merry Xmas, ${fullNameInput}! üöÄ <br> M·∫°nh m·∫Ω l√™n, c√°nh c·ª≠a ƒê·∫°i h·ªçc ƒëang ch·ªù √¥ng!`,
                        `Ch√†o chi·∫øn h·ªØu ${fullNameInput}! ü•Ç <br> M·ªôt ƒë√™m Gi√°ng Sinh tuy·ªát v·ªùi v√† thi t·ªët nh√©!`
                    ];
                    selectedWish = wishesNam[Math.floor(Math.random() * wishesNam.length)];
                }
            }

            // L∆∞u d·ªØ li·ªáu
            localStorage.setItem('visitorName', firstNameOnly);
            localStorage.setItem('userType', userType);

            // Chuy·ªÉn giao di·ªán
            document.getElementById('input-area').style.display = 'none';
            document.getElementById('display-area').style.display = 'block';

            // Ch·∫°y hi·ªáu ·ª©ng ch·ªØ
            new Typed('#typed', {
                strings: [selectedWish],
                typeSpeed: 45,
                showCursor: true,
                onComplete: function() {
                    setTimeout(function() {
                        $('body').fadeOut(1000, function() {
                            window.location.href = "noel1.html"; 
                        });
                    }, 3500);
                }
            });
        }

        // T·∫°o tuy·∫øt r∆°i
        $(document).ready(function() {
            for (let i = 0; i < 60; i++) {
                let dot = document.createElement('div');
                dot.className = 'snow-dot';
                dot.style.left = Math.random() * 100 + 'vw';
                dot.style.top = -10 + 'px';
                dot.style.width = dot.style.height = Math.random() * 3 + 2 + 'px';
                dot.style.animationDuration = Math.random() * 3 + 5 + 's';
                dot.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(dot);
            }
        });
    </script>
</body>
</html>