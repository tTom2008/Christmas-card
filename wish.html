<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry Christmas Greeting</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: #060606;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
            color: white;
            font-family: 'Segoe UI', sans-serif;
        }

        #glass-card {
            position: relative;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            width: 85%;
            max-width: 600px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 10;
            animation: floating 5s ease-in-out infinite;
        }

        input {
            width: 80%; padding: 12px; margin: 20px 0;
            border-radius: 10px; border: 1px solid #FFD700;
            background: rgba(255,255,255,0.1); color: white;
            text-align: center; font-size: 1.1rem; outline: none;
        }
        button {
            padding: 12px 30px; border-radius: 25px; border: none;
            background: linear-gradient(45deg, #FFD700, #B8860B);
            color: black; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        button:hover { transform: scale(1.05); box-shadow: 0 0 15px #FFD700; }

        .greeting-text {
            font-family: 'Dancing Script', 'Segoe UI', cursive;
            font-size: clamp(1.4rem, 4vw, 2.1rem);
            background: linear-gradient(135deg, #FFD700 0%, #FFF8DC 50%, #FFD700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            line-height: 1.6;
        }

        .sub-text {
            margin-top: 20px;
            font-size: 0.8rem;
            color: #666;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .snow-dot {
            position: absolute; background: white; border-radius: 50%; opacity: 0.5;
            pointer-events: none; animation: fall linear infinite;
        }
        @keyframes fall {
            to { transform: translateY(100vh); }
        }

        .typed-cursor {
            color: #FFD700;
        }
    </style>
</head>
<body>

<audio id="bgMusic" autoplay loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
    // ƒê·∫£m b·∫£o nh·∫°c ph√°t ngay khi trang v·ª´a load xong
    window.addEventListener('load', function() {
        const music = document.getElementById('bgMusic');
        const playPromise = music.play();

        if (playPromise !== undefined) {
            playPromise.then(_ => {
                console.log("Nh·∫°c ƒë√£ t·ª± ƒë·ªông ph√°t ·ªü trang B!");
            }).catch(error => {
                // Tr∆∞·ªùng h·ª£p tr√¨nh duy·ªát v·∫´n ch·∫∑n (hi·∫øm khi x·∫£y ra sau khi ƒë√£ click ·ªü trang A)
                console.log("C·∫ßn click ƒë·ªÉ ph√°t nh·∫°c");
                // T·ª± ƒë·ªông ph√°t l·∫°i khi ng∆∞·ªùi d√πng ch·∫°m v√†o m√†n h√¨nh trang B
                document.body.addEventListener('click', () => music.play(), { once: true });
            });
        }
    });
</script>

    <div id="glass-card">
        <div id="input-area">
            <h2 style="color: #FFD700; font-family: 'Dancing Script'; font-size: 2.5rem;">Gi√°ng Sinh cu·ªëi c·∫•p, <br> B·∫°n t√™n l√† g√¨?</h2>
            <input type="text" id="nameInput" placeholder="Nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç v√† t√™n..." autocomplete="off">
            <br>
            <button onclick="startMagic()">Xem ƒëi·ªÅu b·∫•t ng·ªù</button>
        </div>

        <div id="display-area" style="display: none;">
            <div class="greeting-text" id="typed"></div>
            <div class="sub-text">A miracle is about to unfold...</div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
    <script>
        function getCleanText(str) {
            if (!str) return "";
            str = str.replace(/√†|√°|·∫°|·∫£|√£|√¢|·∫ß|·∫•|·∫≠|·∫©|·∫´|ƒÉ|·∫±|·∫Ø|·∫∑|·∫≥|·∫µ/g, "a");
            str = str.replace(/√®|√©|·∫π|·∫ª|·∫Ω|√™|·ªÅ|·∫ø|·ªá|·ªÉ|·ªÖ/g, "e");
            str = str.replace(/√¨|√≠|·ªã|·ªâ|ƒ©/g, "i");
            str = str.replace(/√≤|√≥|·ªç|·ªè|√µ|√¥|·ªì|·ªë|·ªô|·ªï|·ªó|∆°|·ªù|·ªõ|·ª£|·ªü|·ª°/g, "o");
            str = str.replace(/√π|√∫|·ª•|·ªß|≈©|∆∞|·ª´|·ª©|·ª±|·ª≠|·ªØ/g, "u");
            str = str.replace(/·ª≥|√Ω|·ªµ|·ª∑|·ªπ/g, "y");
            str = str.replace(/ƒë/g, "d");
            return str.toLowerCase().trim();
        }

        function startMagic() {
            const fullName = document.getElementById('nameInput').value.trim();
            if (!fullName) {
                alert("H√£y nh·∫≠p t√™n nh√©!");
                return;
            }

            // --- K√çCH HO·∫†T NH·∫†C KHI NH·∫§N N√öT ---
            const music = document.getElementById('bgMusic');
            music.play().catch(error => console.log("Tr√¨nh duy·ªát ch·∫∑n t·ª± ƒë·ªông ph√°t:", error));

            const cleanFull = getCleanText(fullName);
            const nameParts = fullName.split(/\s+/);
            const firstName = getCleanText(nameParts[nameParts.length - 1]);
            const fullID = cleanFull.replace(/\s+/g, "");

            let selectedWish = "";
            let userType = "lop"; 

            if (cleanFull.includes("tuan anh")) {
                userType = "thay";
                selectedWish = `G·ª≠i Th·∫ßy Tu·∫•n Anh! ‚ùÑÔ∏è <br> C·∫£m ∆°n Th·∫ßy ƒë√£ ƒë·∫øn v√† ƒë·ªìng h√†nh c√πng ch√∫ng em trong th√°ng v·ª´a qua. ^500 <br> Ch√∫c Th·∫ßy Gi√°ng Sinh an l√†nh, lu√¥n gi·ªØ v·ªØng ng·ªçn l·ª≠a nhi·ªát huy·∫øt ƒë·ªÉ c√πng t·ª•i em v∆∞·ª£t v≈© m√¥n th√†nh c√¥ng! üéÅ`;
            } 
            else {
                userType = "lop";
                const listNuGoc = ["ngoc han", "my han", "thu huong", "bao ngoc", "nhu ngoc", "tieu phung", "minh thu", "thu trang", "ngoc tram", "cam tu", "thanh phuong"];
                const laNu = listNuGoc.some(tenNu => cleanFull.includes(tenNu));

                if (laNu) {
                    const wishesNu = [
                        `Ch√†o ${fullName}! ‚ùÑÔ∏è <br> Ch√∫c b·∫°n √¥n thi hi·ªáu qu·∫£, ƒë·ªó ƒë√∫ng nguy·ªán v·ªçng 1 nh√©! ‚ú®`,
                        `${fullName} ∆°i! üéÑ <br> Gi√°ng Sinh vui v·∫ª! Lu√¥n gi·ªØ v·ªØng phong ƒë·ªô h·ªçc t·∫≠p ƒë·ªÉ c√° ch√©p h√≥a r·ªìng! ‚ù§Ô∏è`,
                        `G·ª≠i ${fullName}, üéÅ <br> Noel ·∫•m √°p nh√©! Ch√∫c b·∫°n x·ª≠ g·ªçn ƒë·ªëng ƒë·ªÅ c∆∞∆°ng v√† ƒë·∫°t ƒëi·ªÉm cao! ‚ú®`,
                        `Merry Christmas, ${fullName}! ‚ùÑÔ∏è <br> Ch√∫c b·∫°n t·ª± tin ƒë·ªÉ v∆∞·ª£t qua c√°c k·ª≥ thi s·∫Øp t·ªõi th·∫≠t nh·∫π nh√†ng!`,
                        `Ch√∫c ${fullName} üåü <br> Lu√¥n r·∫°ng r·ª° v√† c·∫ßm ch·∫Øc t·∫•m v√© v√†o tr∆∞·ªùng ƒê·∫°i h·ªçc m∆° ∆∞·ªõc nh√©!`,
                        `${fullName} th√¢n m·∫øn! üéÑ <br> Noel cu·ªëi c·∫•p r·ªìi, x·∫£ stress m·ªôt ch√∫t r·ªìi quay l·∫°i chi·∫øn ƒë·∫•u th√¥i!`,
                        `Ch√†o ${fullName}! ‚ùÑÔ∏è <br> Ch√∫c b·∫°n h·ªçc gi·ªèi, thi t·ªët v√† lu√¥n l√† ni·ªÅm t·ª± h√†o c·ªßa l·ªõp!`,
                        `${fullName} √†! üéÅ <br> Noel vui v·∫ª, b·ªõt √°p l·ª±c l·∫°i v√† t·∫≠p trung cao ƒë·ªô ƒë·ªÉ th√†nh c√¥ng nh√©!`,
                        `G·ª≠i t·ªõi ${fullName}, ‚ù§Ô∏è <br> Ch√∫c b·∫°n m·ªôt m√πa ƒë√¥ng ·∫•m l√≤ng v√† thi c·ª≠ thu·∫≠n l·ª£i nh·∫•t!`,
                        `Merry Xmas, ${fullName}! üß∏ <br> Ch√∫c b·∫°n s·ªõm nh·∫≠n ƒë∆∞·ª£c tin vui ƒë·ªó ƒê·∫°i h·ªçc nh∆∞ mong ƒë·ª£i! ‚ú®`
                    ];
                    selectedWish = wishesNu[Math.floor(Math.random() * wishesNu.length)];
                } else {
                    const wishesNam = [
                        `Ch√†o ${fullName}! ‚ùÑÔ∏è <br> Noel ch√°y nh√©! Ch√∫c √¥ng thi ƒë√¢u ƒë·ªó ƒë√≥, phong ƒë·ªô v·ªØng v√†ng! ‚ú®`,
                        `${fullName} ∆°i! üéÑ <br> Gi√°ng Sinh an l√†nh! S·ªõm c√≥ "g·∫•u" s∆∞·ªüi ·∫•m v√† ƒë·ªó nguy·ªán v·ªçng 1! ‚ù§Ô∏è`,
                        `G·ª≠i ${fullName}, üéÅ <br> Ch√∫c √¥ng √¥n thi hi·ªáu qu·∫£, s·ªõm tr·ªü th√†nh T√¢n sinh vi√™n tr∆∞·ªùng Top! ‚ú®`,
                        `Merry Christmas, ${fullName}! ‚ùÑÔ∏è <br> M·∫°nh m·∫Ω l√™n, c√°nh c·ª≠a ƒê·∫°i h·ªçc ƒëang ch·ªù √¥ng chinh ph·ª•c!`,
                        `Ch√∫c ${fullName} üåü <br> Gi·ªØ v·ªØng b·∫£n lƒ©nh, h·ªçc t·∫≠p xuy√™n ƒë√™m v√† ƒë·ªó NV1 xu·∫•t s·∫Øc nh√©!`,
                        `Ch√†o chi·∫øn h·ªØu ${fullName}! üéÑ <br> Noel vui, t·∫≠p trung cao ƒë·ªô cho k·ª≥ thi s·∫Øp t·ªõi n√†o!`,
                        `Ch√†o ${fullName}! üéÑ <br> Ch√∫c √¥ng b·∫£n lƒ©nh nh∆∞ chi·∫øn binh, ƒë·ªó tr∆∞·ªùng Top nh√©!`,
                        `Merry Xmas, ${fullName}! üöÄ <br> Ti·∫øn v·ªÅ ph√≠a tr∆∞·ªõc, th√†nh c√¥ng ƒëang ch·ªù √¥ng!`,
                        `Ch√∫c ${fullName} ü•Ç <br> M·ªôt ƒë√™m Gi√°ng Sinh tuy·ªát v·ªùi v√† ƒë·∫ßy d·ª± ƒë·ªãnh m·ªõi m·∫ª!`
                    ];
                    selectedWish = wishesNam[Math.floor(Math.random() * wishesNam.length)];
                }
            }

            localStorage.setItem('visitorName', firstName);
            localStorage.setItem('visitorID', fullID);
            localStorage.setItem('userType', userType);

            document.getElementById('input-area').style.display = 'none';
            document.getElementById('display-area').style.display = 'block';

            new Typed('#typed', {
                strings: [selectedWish],
                typeSpeed: 45,
                showCursor: true,
                onComplete: function() {
                    setTimeout(function() {
                        $('body').fadeOut(1000, function() {
                            window.location.href = "noel1.html"; 
                        });
                    }, 3500);
                }
            });
        }

        $(document).ready(function() {
            for (let i = 0; i < 60; i++) {
                let dot = document.createElement('div');
                dot.className = 'snow-dot';
                dot.style.left = Math.random() * 100 + 'vw';
                dot.style.top = -10 + 'px';
                dot.style.width = dot.style.height = Math.random() * 3 + 2 + 'px';
                dot.style.animationDuration = Math.random() * 3 + 5 + 's';
                dot.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(dot);
            }
        });
    </script>
</body>
</html>